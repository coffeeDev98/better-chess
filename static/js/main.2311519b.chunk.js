(this["webpackJsonpbetter-chess"]=this["webpackJsonpbetter-chess"]||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),o=n(24),s=n.n(o),c=(n(39),n(40),n(4)),u=n(5),d=n(34),l=n(2),g="BOARD_MOVE_UPDATE",b=n(41),h=function(e){var t=e.pieceSquare,n=e.history,r=(n.length&&n[n.length-1].from,n.length&&n[n.length-1].to);return Object(l.a)(Object(u.a)({},t,{backgroundColor:"rgba(123,97,255,0.5)"}),n.length&&Object(u.a)({},r,{backgroundColor:"rgba(123,97,255,0.5)"}))},f=function(e,t){var n=Object(a.useState)(new b("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")),r=Object(c.a)(n,1)[0],i=Object(a.useState)({fen:"start",dropSquareStyle:{},squareStyles:{},pieceSquare:"",square:"",history:[],boardPosition:{}}),o=Object(c.a)(i,2),s=o[0],f=o[1];Object(a.useEffect)((function(){console.log("BOARD POSITION: ",s.boardPosition)}),[s.boardPosition]),Object(a.useEffect)((function(){var t;e.channel&&(null===(t=e.channel)||void 0===t||t.on("ChannelMessage",(function(e){var t,n=(t=e.text,JSON.parse(t));switch(console.log("MESSAGE DATA: ",n),n.type){case g:v({sourceSquare:n.json.move.from,targetSquare:n.json.move.to});break;default:console.log("INVALID OPERATION")}})))}),[e.channel]);var j=function(e,t,n){var a=e,i=t;r.move({from:a,to:i,promotion:n}),f(Object(l.a)(Object(l.a)({},s),{},{fen:r.fen()}))},v=function(e){for(var n=e.sourceSquare,a=e.targetSquare,i=r.move({from:n,to:a}),o=r.moves({verbose:!0}),c=0,u=o.length;c<u;c++)if(-1!==o[c].flags.indexOf("p")&&o[c].from===n)return console.log("opening promotional modal"),void j(n,a,"r");null!==i&&(f((function(e){var t=e.history,n=e.pieceSquare;return Object(l.a)(Object(l.a)({},s),{},{fen:r.fen(),history:r.history({verbose:!0}),squareStyles:h({pieceSquare:n,history:t})})})),t.updateBoard(i))};return{setBoardPosition:function(e){f(Object(l.a)(Object(l.a)({},s),{},{boardPosition:e}))},fen:s.fen,onDrop:v,onMouseOverSquare:function(e){var t=r.moves({square:e,verbose:!0});if(0!==t.length){for(var n=[],a=0;a<t.length;a++)n.push(t[a].to);console.log("SQUARESTOHIGHLIGHT: ",n),function(e,t){var n=[e].concat(Object(d.a)(t)).reduce((function(e,t){return Object(l.a)(Object(l.a)(Object(l.a)({},e),Object(u.a)({},t,{background:"radial-gradient(circle, rgb(123,97,255,0.5) 20%, transparent 0%)",borderRadius:"50%"})),h({history:s.history,pieceSquare:s.pieceSquare}))}),{});f((function(e){var t=e.squareStyles;return Object(l.a)(Object(l.a)({},s),{},{squareStyles:Object(l.a)(Object(l.a)({},t),n)})}))}(e,n)}},onMouseOutSquare:function(e){f((function(e){var t=e.pieceSquare,n=e.history;return Object(l.a)(Object(l.a)({},s),{},{squareStyles:h({pieceSquare:t,history:n})})}))},squareStyles:s.squareStyles,onDragOverSquare:function(e){f(Object(l.a)(Object(l.a)({},s),{},{dropSquareStyle:"e4"===e||"d4"===e||"e5"===e||"d5"===e?{backgroundColor:"cornFlowerBlue"}:{boxShadow:"inset 0 0 1px 4px rgb(255, 255, 0)"}}))},onSquareClick:function(e){f((function(t){var n=t.history;return Object(l.a)(Object(l.a)({},s),{},{squareStyles:h({pieceSquare:e,history:n}),pieceSquare:e})}));for(var n=r.move({from:s.pieceSquare,to:e}),a=r.moves({verbose:!0}),i=0,o=a.length;i<o;i++)if(-1!==a[i].flags.indexOf("p")&&a[i].from===s.pieceSquare)return console.log("opening promotional modal"),void j(s.pieceSquare,e,"r");null!==n&&(f(Object(l.a)(Object(l.a)({},s),{},{fen:r.fen(),history:r.history({verbose:!0}),pieceSquare:""})),t.updateBoard(n))},onSquareRightClick:function(e){return f(Object(l.a)(Object(l.a)({},s),{},{squareStyles:Object(u.a)({},e,{backgroundColor:"deepPink"})}))}}},j=function(e){var t=e.Agora;return{updateBoard:function(e){var n={move:e};null===t||void 0===t||t.sendChannelMessage(n,g)}}},v=n(25),O=n.n(v),p=n(13),m=n.n(p),S=n(26),q=n(27),w=n.n(q),y=n(28),x=n.n(y),P={messageParser:function(e){return{text:(t=e,JSON.stringify(t)),messageType:"TEXT"};var t}},k=function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],r=t[1],i=w.a.createInstance("f4b36b6c897e41bfaa3904d75da40777"),o={uid:(Math.floor(9e4*Math.random())+1e4).toString(),token:""};Object(a.useEffect)((function(){(function(){var e=Object(S.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.a.get("https://agoratokenserver-demo.herokuapp.com/access_token?channel=test&uid=".concat(o.uid)).then((function(e){var t;console.log(e),o.token=(null===(t=e.data)||void 0===t?void 0:t.token)||"",i.login(o).then((function(){console.log("Login successful");var e=i.createChannel("test");e.join(),r(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(){console.log("integrations successful")}))}),[]),Object(a.useEffect)((function(){n&&(null===n||void 0===n||n.on("MemberJoined",(function(e){console.log("New member joined: ",e)})),null===n||void 0===n||n.on("MemberLeft",(function(e){console.log("Member left: ",e)})))}),[n]);return{channel:n,playerMeta:o,sendChannelMessage:function(e,t){var r={uid:o.uid,json:e,type:t};console.log(P.messageParser(r)),null===n||void 0===n||n.sendMessage(P.messageParser(r)).then((function(){}))}}},D=n.p+"static/media/wK.3b342df8.svg",B=n.p+"static/media/wQ.785db365.svg",C=n.p+"static/media/wB.56f72474.svg",M=n.p+"static/media/wR.33cf0258.svg",E=n.p+"static/media/wN.d5fa39eb.svg",N=n.p+"static/media/wP.5f74a9fe.svg",R=n.p+"static/media/bK.e57316c7.svg",W=n.p+"static/media/bQ.c21470b8.svg",A=n.p+"static/media/bB.1f023e3e.svg",I=n.p+"static/media/bR.2724e583.svg",T=n.p+"static/media/bN.a46c4723.svg",Q=n.p+"static/media/bP.d9262a65.svg",F=n(1),K=function(e){var t=e.dimension,n=k(),r=j({Agora:n}),a=f(n,r),i=a.setBoardPosition,o=a.fen,s=a.onDrop,c=a.onMouseOverSquare,u=a.onMouseOutSquare,d=a.squareStyles,l=a.onDragOverSquare,g=a.onSquareClick,b=a.onSquareRightClick,h={wK:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:D,alt:"wK"})},wQ:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:B,alt:"wQ"})},wB:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:C,alt:"wB"})},wR:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:M,alt:"wR"})},wN:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:E,alt:"wN"})},wP:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:N,alt:"wP"})},bK:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:R,alt:"bK"})},bQ:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:W,alt:"bQ"})},bB:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:A,alt:"bB"})},bR:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:I,alt:"bR"})},bN:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:T,alt:"bN"})},bP:function(e){var t=e.squareWidth;e.isDragging;return Object(F.jsx)("img",{style:{width:t,height:t},src:Q,alt:"bP"})}};return Object(F.jsx)(F.Fragment,{children:Object(F.jsx)(O.a,{position:o,getPosition:i,lightSquareStyle:{backgroundColor:"#E8EDF9"},darkSquareStyle:{backgroundColor:"#B7C0D8"},pieces:h,boardStyle:{width:t,height:t,position:"relative"},width:t,onDrop:s,onMouseOverSquare:c,onMouseOutSquare:u,squareStyles:d,onDragOverSquare:l,onSquareClick:g,onSquareRightClick:b})})},L=n(29),J=n(30).a.div(r||(r=Object(L.a)(['\n  display: grid;\n  width: 100%;\n  max-width: 1440px;\n  background: black;\n  grid-template-columns: 66% 37%;\n  grid-template-areas: "board sidePanel";\n  .board-container {\n    grid-area: board;\n    border: 10px solid rgba(255, 255, 255);\n  }\n  }\n  .side-panel {\n    grid-area: sidePanel;\n    width: 100%;\n    height: 100%;\n    background: #2b2b34;\n    border: 2px solid rgba(255, 255, 255, 0.1);\n    border-radius: 0 24px 24px 0;\n  }\n']))),G=function(e){var t=Object(a.useState)(),n=Object(c.a)(t,2),r=n[0],i=n[1];Object(a.useEffect)((function(){return o(),window.addEventListener("resize",o),function(){return window.removeEventListener("resize",o)}}),[]);var o=function(){var e;i(null===(e=window.document.getElementById("board-container"))||void 0===e?void 0:e.clientWidth)};return Object(F.jsx)(F.Fragment,{children:Object(F.jsxs)(J,{children:[Object(F.jsx)("div",{id:"board-container",className:"board-container",children:Object(F.jsx)(K,{dimension:r})}),Object(F.jsx)("div",{className:"side-panel"})]})})};var H=function(){return Object(F.jsx)("div",{className:"app",children:Object(F.jsx)(G,{})})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};s.a.render(Object(F.jsx)(i.a.StrictMode,{children:Object(F.jsx)(H,{})}),document.getElementById("root")),_()}},[[67,1,2]]]);
//# sourceMappingURL=main.2311519b.chunk.js.map